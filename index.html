<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Personal Exercise Tracker</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Chart.js for progress visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#4f46e5">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        .light-mode {
            background-color: #f0f4f8;
            color: #334155;
        }
        .dark-mode {
            background-color: #1e293b;
            color: #e2e8f0;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1.5rem;
        }
        .card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 1rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            margin-bottom: 2rem;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .dark-mode .card {
            background: rgba(30, 41, 59, 0.7);
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 25px -5px rgba(0, 0, 0, 0.2);
        }
        .btn-primary {
            background: linear-gradient(135deg, #4f46e5, #7c3aed);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            font-weight: 600;
            transition: transform 0.2s ease, background 0.2s ease;
        }
        .btn-primary:hover {
            background: linear-gradient(135deg, #4338ca, #6d28d9);
            transform: scale(1.05);
        }
        .btn-secondary, .btn-success, .btn-danger {
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            font-weight: 600;
            transition: transform 0.2s ease, background-color 0.2s ease;
        }
        .btn-secondary { background-color: #6b7280; color: white; }
        .btn-secondary:hover { background-color: #4b5563; transform: scale(1.05); }
        .btn-success { background-color: #10b981; color: white; }
        .btn-success:hover { background-color: #059669; transform: scale(1.05); }
        .btn-danger { background-color: #ef4444; color: white; }
        .btn-danger:hover { background-color: #dc2626; transform: scale(1.05); }
        .youtube-embed-container {
            position: relative;
            width: 100%;
            padding-bottom: 56.25%;
            height: 0;
            overflow: hidden;
            border-radius: 0.75rem;
        }
        .youtube-embed-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: 0;
        }
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 0.5rem;
        }
        .calendar-day {
            padding: 0.75rem;
            border-radius: 0.5rem;
            text-align: center;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.2s ease, transform 0.2s ease;
        }
        .calendar-day.current-month {
            background-color: #e2e8f0;
        }
        .dark-mode .calendar-day.current-month {
            background-color: #475569;
        }
        .calendar-day.today {
            border: 2px solid #4f46e5;
        }
        .calendar-day.completed {
            background-color: #d1fae5;
            color: #065f46;
        }
        .dark-mode .calendar-day.completed {
            background-color: #065f46;
            color: #d1fae5;
        }
        .calendar-day.skipped {
            background-color: #fee2e2;
            color: #991b1b;
        }
        .dark-mode .calendar-day.skipped {
            background-color: #991b1b;
            color: #fee2e2;
        }
        .calendar-day:not(.current-month) {
            opacity: 0.5;
            cursor: default;
        }
        .calendar-day:hover:not(.skipped):not(.completed):not(.today):not(.current-month) {
            background-color: #cbd5e1;
        }
        .dark-mode .calendar-day:hover:not(.skipped):not(.completed):not(.today):not(.current-month) {
            background-color: #64748b;
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            background: rgba(255, 255, 255, 0.9);
            margin: auto;
            padding: 20px;
            border-radius: 1rem;
            width: 80%;
            max-width: 500px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        .dark-mode .modal-content {
            background: rgba(30, 41, 59, 0.9);
            color: #e2e8f0;
        }
        .close-button {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }
        .close-button:hover,
        .close-button:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }
        .dark-mode .close-button:hover,
        .dark-mode .close-button:focus {
            color: #e2e8f0;
        }
        .bottom-nav {
            position: fixed;
            bottom: 0;
            width: 100%;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            display: none;
        }
        .dark-mode .bottom-nav {
            background: rgba(30, 41, 59, 0.7);
        }
        @media (max-width: 768px) {
            .bottom-nav { display: flex; }
            #sidebar { display: none; }
        }
        .streak-counter {
            display: inline-flex;
            align-items: center;
            background: #4f46e5;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.75rem;
            font-weight: 600;
        }
    </style>
</head>
<body class="light-mode">
    <header class="bg-gradient-to-r from-indigo-600 to-purple-600 text-white p-6 shadow-md">
        <div class="container flex justify-between items-center">
            <h1 class="text-3xl font-bold">üèãÔ∏è‚Äç‚ôÇÔ∏è My Daily Fitness</h1>
            <div class="flex items-center space-x-4">
                <button id="theme-toggle" class="text-white focus:outline-none">
                    <i class="fas fa-moon text-2xl"></i>
                </button>
                <button id="toggle-sidebar" class="md:hidden text-white focus:outline-none">
                    <i class="fas fa-bars text-2xl"></i>
                </button>
            </div>
        </div>
    </header>

    <div class="container flex flex-col md:flex-row mt-8">
        <aside id="sidebar" class="md:w-1/4 p-4 md:pr-8 bg-transparent rounded-lg shadow-md mb-6 md:mb-0 md:block hidden">
            <nav>
                <ul class="space-y-4">
                    <li><a href="#daily-plan" class="text-lg font-medium text-indigo-700 dark-mode:text-indigo-300 hover:text-indigo-900 dark-mode:hover:text-indigo-100 flex items-center"><i class="fas fa-calendar-alt mr-2"></i>Daily Plan</a></li>
                    <li><a href="#current-workout" class="text-lg font-medium text-indigo-700 dark-mode:text-indigo-300 hover:text-indigo-900 dark-mode:hover:text-indigo-100 flex items-center"><i class="fas fa-dumbbell mr-2"></i>Current Workout</a></li>
                    <li><a href="#progress-calendar" class="text-lg font-medium text-indigo-700 dark-mode:text-indigo-300 hover:text-indigo-900 dark-mode:hover:text-indigo-100 flex items-center"><i class="fas fa-chart-line mr-2"></i>Progress</a></li>
                    <li><a href="#motivation-tips" class="text-lg font-medium text-indigo-700 dark-mode:text-indigo-300 hover:text-indigo-900 dark-mode:hover:text-indigo-100 flex items-center"><i class="fas fa-lightbulb mr-2"></i>Motivation</a></li>
                    <li><a href="#custom-exercises" class="text-lg font-medium text-indigo-700 dark-mode:text-indigo-300 hover:text-indigo-900 dark-mode:hover:text-indigo-100 flex items-center"><i class="fas fa-plus-circle mr-2"></i>Custom Exercises</a></li>
                </ul>
            </nav>
        </aside>

        <main class="md:w-3/4 md:pl-8">
            <section id="daily-plan" class="card">
                <h2 class="text-2xl font-semibold text-indigo-700 dark-mode:text-indigo-300 mb-4 flex items-center"><i class="fas fa-clipboard-list mr-2"></i>1. Daily Exercise Plan (15‚Äì25 min)</h2>
                <div class="flex items-center mb-4">
                    <span class="streak-counter"><i class="fas fa-fire mr-2"></i>Streak: <span id="streak-count">0</span> days</span>
                </div>
                <p class="text-gray-600 dark-mode:text-gray-300 mb-4">Frequency: 6 days/week | Time: Best in morning (energy uplift + discipline)</p>
                <div class="mb-6">
                    <h3 class="text-xl font-medium text-gray-700 dark-mode:text-gray-200 mb-2 flex items-center"><i class="fas fa-sun mr-2"></i>Warm-Up (3 min) ‚Äì Roz</h3>
                    <ul class="list-disc list-inside space-y-2 text-gray-600 dark-mode:text-gray-300" id="warm-up-list"></ul>
                </div>
                <div class="mb-6">
                    <h3 class="text-xl font-medium text-gray-700 dark-mode:text-gray-200 mb-2 flex items-center"><i class="fas fa-running mr-2"></i>Main Workout (12‚Äì15 min) ‚Äì Alternate Days:</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="bg-blue-50 dark-mode:bg-blue-900 p-4 rounded-lg">
                            <h4 class="font-semibold text-lg text-blue-700 dark-mode:text-blue-300 mb-2 flex items-center"><i class="fas fa-check-circle mr-2"></i>DAY 1, 3, 5: Core + Posture</h4>
                            <ul class="list-disc list-inside space-y-2 text-gray-600 dark-mode:text-gray-300" id="core-posture-list"></ul>
                        </div>
                        <div class="bg-green-50 dark-mode:bg-green-900 p-4 rounded-lg">
                            <h4 class="font-semibold text-lg text-green-700 dark-mode:text-green-300 mb-2 flex items-center"><i class="fas fa-check-circle mr-2"></i>DAY 2, 4, 6: Stamina + Full Body</h4>
                            <ul class="list-disc list-inside space-y-2 text-gray-600 dark-mode:text-gray-300" id="stamina-full-body-list"></ul>
                        </div>
                    </div>
                </div>
                <div class="mb-6">
                    <h3 class="text-xl font-medium text-gray-700 dark-mode:text-gray-200 mb-2 flex items-center"><i class="fas fa-stretch mr-2"></i>2. Static Stretching Routine (10 min)</h3>
                    <p class="text-gray-600 dark-mode:text-gray-300 mb-2">Do after workout + before bed (night)</p>
                    <ul class="list-disc list-inside space-y-2 text-gray-600 dark-mode:text-gray-300" id="stretching-list"></ul>
                </div>
                <div class="mb-6">
                    <h3 class="text-xl font-medium text-gray-700 dark-mode:text-gray-200 mb-2 flex items-center"><i class="fas fa-heartbeat mr-2"></i>3. Kegel & Pelvic Floor Plan (Daily 10 min)</h3>
                    <p class="text-gray-600 dark-mode:text-gray-300 mb-2">Goal: Urge control, sexual stamina, pelvic strength</p>
                    <p class="text-gray-600 dark-mode:text-gray-300 mb-2">Time: Raat me (bed pe late hue bhi kar sakte ho)</p>
                    <ul class="list-disc list-inside space-y-2 text-gray-600 dark-mode:text-gray-300" id="kegel-list"></ul>
                    <p class="text-gray-500 dark-mode:text-gray-400 text-sm mt-2">üß† Reminder: Kegel karte waqt stomach, legs, ***** tense na ho ‚Äî sirf andar ka control. Breathe normally.</p>
                </div>
                <button id="start-workout-btn" class="btn-primary w-full md:w-auto mt-4">Start Today's Workout</button>
                <button id="set-reminder-btn" class="btn-secondary w-full md:w-auto mt-4 ml-0 md:ml-4">Set Reminder</button>
            </section>

            <section id="current-workout" class="card hidden">
                <h2 class="text-2xl font-semibold text-indigo-700 dark-mode:text-indigo-300 mb-4 flex items-center"><i class="fas fa-play-circle mr-2"></i>Current Workout</h2>
                <div id="exercise-display" class="text-center">
                    <h3 id="current-exercise-name" class="text-3xl font-bold text-gray-800 dark-mode:text-gray-100 mb-2"></h3>
                    <p id="current-exercise-reps" class="text-xl text-gray-600 dark-mode:text-gray-300 mb-4"></p>
                    <div id="timer-display" class="text-5xl font-extrabold text-indigo-600 dark-mode:text-indigo-300 mb-6">00:00</div>
                    <div class="flex justify-center space-x-4 mb-6">
                        <button id="start-pause-btn" class="btn-primary"><i class="fas fa-play mr-2"></i>Start</button>
                        <button id="reset-btn" class="btn-secondary"><i class="fas fa-redo mr-2"></i>Reset</button>
                        <button id="next-exercise-btn" class="btn-success"><i class="fas fa-forward mr-2"></i>Next</button>
                    </div>
                    <div id="youtube-video-container" class="youtube-embed-container mb-6"></div>
                    <p id="next-exercise-info" class="text-lg text-gray-700 dark-mode:text-gray-300 mt-4"></p>
                </div>
            </section>

            <section id="progress-calendar" class="card">
                <h2 class="text-2xl font-semibold text-indigo-700 dark-mode:text-indigo-300 mb-4 flex items-center"><i class="fas fa-calendar-check mr-2"></i>Daily Progress Calendar</h2>
                <div class="flex justify-between items-center mb-4">
                    <button id="prev-month-btn" class="btn-secondary px-4 py-2 rounded-lg"><i class="fas fa-chevron-left"></i></button>
                    <h3 id="current-month-year" class="text-xl font-semibold"></h3>
                    <button id="next-month-btn" class="btn-secondary px-4 py-2 rounded-lg"><i class="fas fa-chevron-right"></i></button>
                </div>
                <div class="calendar-grid mb-4">
                    <div class="font-bold text-center text-gray-700 dark-mode:text-gray-200">Sun</div>
                    <div class="font-bold text-center text-gray-700 dark-mode:text-gray-200">Mon</div>
                    <div class="font-bold text-center text-gray-700 dark-mode:text-gray-200">Tue</div>
                    <div class="font-bold text-center text-gray-700 dark-mode:text-gray-200">Wed</div>
                    <div class="font-bold text-center text-gray-700 dark-mode:text-gray-200">Thu</div>
                    <div class="font-bold text-center text-gray-700 dark-mode:text-gray-200">Fri</div>
                    <div class="font-bold text-center text-gray-700 dark-mode:text-gray-200">Sat</div>
                </div>
                <div id="calendar-days" class="calendar-grid"></div>
                <div class="mt-6">
                    <canvas id="progress-chart" height="100"></canvas>
                </div>
                <div class="mt-6 p-4 bg-blue-50 dark-mode:bg-blue-900 rounded-lg text-gray-700 dark-mode:text-gray-300">
                    <p class="font-semibold mb-2">Mark Today's Progress:</p>
                    <div class="flex space-x-4">
                        <button id="mark-completed-btn" class="btn-success flex-1"><i class="fas fa-check-circle mr-2"></i>Mark Completed</button>
                        <button id="mark-skipped-btn" class="btn-danger flex-1"><i class="fas fa-times-circle mr-2"></i>Mark Skipped</button>
                    </div>
                </div>
            </section>

            <section id="custom-exercises" class="card">
                <h2 class="text-2xl font-semibold text-indigo-700 dark-mode:text-indigo-300 mb-4 flex items-center"><i class="fas fa-plus-circle mr-2"></i>Add Custom Exercise</h2>
                <div class="space-y-4">
                    <input id="custom-exercise-name" type="text" placeholder="Exercise Name" class="w-full p-2 border rounded-lg dark-mode:bg-gray-700 dark-mode:text-gray-200">
                    <input id="custom-exercise-reps" type="text" placeholder="Reps (e.g., 10 reps)" class="w-full p-2 border rounded-lg dark-mode:bg-gray-700 dark-mode:text-gray-200">
                    <input id="custom-exercise-duration" type="number" placeholder="Duration (seconds)" class="w-full p-2 border rounded-lg dark-mode:bg-gray-700 dark-mode:text-gray-200">
                    <input id="custom-exercise-video" type="text" placeholder="YouTube Video URL" class="w-full p-2 border rounded-lg dark-mode:bg-gray-700 dark-mode:text-gray-200">
                    <select id="custom-exercise-type" class="w-full p-2 border rounded-lg dark-mode:bg-gray-700 dark-mode:text-gray-200">
                        <option value="warmUp">Warm-Up</option>
                        <option value="corePosture">Core + Posture</option>
                        <option value="staminaFullBody">Stamina + Full Body</option>
                        <option value="stretching">Stretching</option>
                        <option value="kegel">Kegel</option>
                    </select>
                    <button id="add-custom-exercise-btn" class="btn-primary w-full">Add Exercise</button>
                </div>
                <div class="mt-6">
                    <h3 class="text-xl font-medium text-gray-700 dark-mode:text-gray-200 mb-2">Your Custom Exercises</h3>
                    <ul id="custom-exercise-list" class="list-disc list-inside space-y-2 text-gray-600 dark-mode:text-gray-300"></ul>
                </div>
            </section>

            <section id="motivation-tips" class="card">
                <h2 class="text-2xl font-semibold text-indigo-700 dark-mode:text-indigo-300 mb-4 flex items-center"><i class="fas fa-lightbulb mr-2"></i>Motivation Tips</h2>
                <ul class="list-disc list-inside space-y-3 text-gray-600 dark-mode:text-gray-300">
                    <li><span class="font-semibold">Energy loss post-masturbation:</span> Do light Kegel + stretching next 15 min ‚Üí control wapas aata hai.</li>
                    <li><span class="font-semibold">Tight joints:</span> Stretching daily rakhna mandatory hai ‚Äî 1 month me difference dikhne lagega.</li>
                    <li><span class="font-semibold">Low morning energy:</span> Start with deep breaths + jumping jacks √ó 20 ‚Äì brain active ho jata hai.</li>
                    <li><span class="font-semibold">Urges control:</span> Kegel + Mindful breath + focus shift (phone off, cold splash, walk 1 min)</li>
                </ul>
            </section>
        </main>
    </div>

    <nav class="bottom-nav flex justify-around p-4 md:hidden">
        <a href="#daily-plan" class="text-indigo-700 dark-mode:text-indigo-300 hover:text-indigo-900 dark-mode:hover:text-indigo-100"><i class="fas fa-calendar-alt text-xl"></i></a>
        <a href="#current-workout" class="text-indigo-700 dark-mode:text-indigo-300 hover:text-indigo-900 dark-mode:hover:text-indigo-100"><i class="fas fa-dumbbell text-xl"></i></a>
        <a href="#progress-calendar" class="text-indigo-700 dark-mode:text-indigo-300 hover:text-indigo-900 dark-mode:hover:text-indigo-100"><i class="fas fa-chart-line text-xl"></i></a>
        <a href="#motivation-tips" class="text-indigo-700 dark-mode:text-indigo-300 hover:text-indigo-900 dark-mode:hover:text-indigo-100"><i class="fas fa-lightbulb text-xl"></i></a>
        <a href="#custom-exercises" class="text-indigo-700 dark-mode:text-indigo-300 hover:text-indigo-900 dark-mode:hover:text-indigo-100"><i class="fas fa-plus-circle text-xl"></i></a>
    </nav>

    <div id="message-modal" class="modal">
        <div class="modal-content">
            <span class="close-button">√ó</span>
            <p id="modal-message" class="text-lg text-center"></p>
            <div class="flex justify-center mt-4">
                <button id="modal-ok-btn" class="btn-primary">OK</button>
            </div>
        </div>
    </div>

    <script>
        // Utility Functions
        function showMessage(message) {
            const modal = document.getElementById('message-modal');
            const modalMessage = document.getElementById('modal-message');
            const closeButton = document.querySelector('.close-button');
            const okButton = document.getElementById('modal-ok-btn');
            modalMessage.textContent = message;
            modal.style.display = 'flex';
            const closeModal = () => modal.style.display = 'none';
            closeButton.onclick = closeModal;
            okButton.onclick = closeModal;
            window.onclick = (event) => { if (event.target == modal) closeModal(); };
        }

        // Theme Toggle
        const themeToggleBtn = document.getElementById('theme-toggle');
        themeToggleBtn.addEventListener('click', () => {
            document.body.classList.toggle('light-mode');
            document.body.classList.toggle('dark-mode');
            const isDarkMode = document.body.classList.contains('dark-mode');
            themeToggleBtn.innerHTML = `<i class="fas fa-${isDarkMode ? 'sun' : 'moon'} text-2xl"></i>`;
            localStorage.setItem('theme', isDarkMode ? 'dark' : 'light');
            updateChart(); // Update chart colors for theme
        });

        // Load theme from localStorage
        if (localStorage.getItem('theme') === 'dark') {
            document.body.classList.remove('light-mode');
            document.body.classList.add('dark-mode');
            themeToggleBtn.innerHTML = '<i class="fas fa-sun text-2xl"></i>';
        }

        // Exercise Data
        let exercises = JSON.parse(localStorage.getItem('exercises')) || {
            warmUp: [
                { name: "Neck rolls", reps: "5 (each side)", duration: 30, video: "https://www.youtube.com/embed/M97vR2x4YMw" },
                { name: "Shoulder rotation", reps: "10", duration: 30, video: "https://www.youtube.com/embed/L1c2J85gQ_E" },
                { name: "Jumping jacks", reps: "20", duration: 30, video: "https://www.youtube.com/embed/Up03b-t9k5w" },
                { name: "Arm swings", reps: "10", duration: 30, video: "https://www.youtube.com/embed/yQpQh0N2w8Q" },
                { name: "Light march in place", reps: "30 sec", duration: 30, video: "https://www.youtube.com/embed/E-1H0_o982A" }
            ],
            corePosture: [
                { name: "Wall Angel", reps: "10 reps", duration: 60, video: "https://www.youtube.com/embed/fW_g8I_aK6c" },
                { name: "Bird Dog", reps: "10 reps each side", duration: 60, video: "https://www.youtube.com/embed/wiFNA3QB_Ew" },
                { name: "Glute Bridge", reps: "15", duration: 60, video: "https://www.youtube.com/embed/ayh01z2U65g" },
                { name: "Superman Hold", reps: "30 sec", duration: 30, video: "https://www.youtube.com/embed/z6CgC_e1y4M" },
                { name: "Plank", reps: "start 20 sec ‚Üí aim 1 min", duration: 60, video: "https://www.youtube.com/embed/ASdvN_Xok6c" }
            ],
            staminaFullBody: [
                { name: "Squats", reps: "15", duration: 60, video: "https://www.youtube.com/embed/ultWfYNEkEM" },
                { name: "Incline Push-ups", reps: "10", duration: 60, video: "https://www.youtube.com/embed/3L_s6p8s96E" },
                { name: "Step-up", reps: "10/leg", duration: 60, video: "https://www.youtube.com/embed/V6dK11Q4yI8" },
                { name: "High Knees", reps: "30 sec", duration: 30, video: "https://www.youtube.com/embed/QP_x6s-vQ8I" },
                { name: "Side lunges", reps: "10", duration: 60, video: "https://www.youtube.com/embed/Zg2C_u_gqjY" },
                { name: "Mountain Climbers", reps: "20", duration: 60, video: "https://www.youtube.com/embed/nmwgirgX2QU" }
            ],
            stretching: [
                { name: "Toe Touch Hold", reps: "30 sec", duration: 30, video: "https://www.youtube.com/embed/S_x2F603M5o" },
                { name: "Cat-Cow Stretch", reps: "30 sec", duration: 30, video: "https://www.youtube.com/embed/kqn2_Xg_J5E" },
                { name: "Seated Forward Fold", reps: "30 sec", duration: 30, video: "https://www.youtube.com/embed/M1Q92B6W66U" },
                { name: "Butterfly Stretch", reps: "30 sec", duration: 30, video: "https://www.youtube.com/embed/HwJ8d_wG160" },
                { name: "Child's Pose", reps: "1 min", duration: 60, video: "https://www.youtube.com/embed/2MJGg-d_M04" },
                { name: "Shoulder Stretch", reps: "30 sec each", duration: 60, video: "https://www.youtube.com/embed/e_yWp9g9R7g" },
                { name: "Neck side stretch", reps: "30 sec each", duration: 60, video: "https://www.youtube.com/embed/z4tC99z3N8U" },
                { name: "Deep breathing", reps: "1 min", duration: 60, video: "https://www.youtube.com/embed/nmF1f7C442Q" }
            ],
            kegel: [
                { name: "Basic Kegel Squeeze", reps: "Hold 5 sec √ó 10 reps", duration: 50, video: "https://www.youtube.com/embed/0G7L-sU39m0" },
                { name: "Fast Kegel Pulses", reps: "1 sec hold/release √ó 15 reps", duration: 15, video: "https://www.youtube.com/embed/0G7L-sU39m0" },
                { name: "Elevator Kegel", reps: "tighten slowly till full ‚Üí relax slowly √ó 5 reps", duration: 50, video: "https://www.youtube.com/embed/0G7L-sU39m0" },
                { name: "Glute Bridge Hold + Kegel", reps: "10 sec √ó 5 reps", duration: 50, video: "https://www.youtube.com/embed/ayh01z2U65g" },
                { name: "Relaxation Breathing", reps: "Belly breathing √ó 2 min", duration: 120, video: "https://www.youtube.com/embed/nmF1f7C442Q" }
            ]
        };

        // DOM Elements
        const warmUpList = document.getElementById('warm-up-list');
        const corePostureList = document.getElementById('core-posture-list');
        const staminaFullBodyList = document.getElementById('stamina-full-body-list');
        const stretchingList = document.getElementById('stretching-list');
        const kegelList = document.getElementById('kegel-list');
        const startWorkoutBtn = document.getElementById('start-workout-btn');
        const currentWorkoutSection = document.getElementById('current-workout');
        const dailyPlanSection = document.getElementById('daily-plan');
        const currentExerciseName = document.getElementById('current-exercise-name');
        const currentExerciseReps = document.getElementById('current-exercise-reps');
        const timerDisplay = document.getElementById('timer-display');
        const startPauseBtn = document.getElementById('start-pause-btn');
        const resetBtn = document.getElementById('reset-btn');
        const nextExerciseBtn = document.getElementById('next-exercise-btn');
        const youtubeVideoContainer = document.getElementById('youtube-video-container');
        const nextExerciseInfo = document.getElementById('next-exercise-info');
        const prevMonthBtn = document.getElementById('prev-month-btn');
        const nextMonthBtn = document.getElementById('next-month-btn');
        const currentMonthYearDisplay = document.getElementById('current-month-year');
        const calendarDaysContainer = document.getElementById('calendar-days');
        const markCompletedBtn = document.getElementById('mark-completed-btn');
        const markSkippedBtn = document.getElementById('mark-skipped-btn');
        const toggleSidebarBtn = document.getElementById('toggle-sidebar');
        const sidebar = document.getElementById('sidebar');
        const setReminderBtn = document.getElementById('set-reminder-btn');
        const customExerciseName = document.getElementById('custom-exercise-name');
        const customExerciseReps = document.getElementById('custom-exercise-reps');
        const customExerciseDuration = document.getElementById('custom-exercise-duration');
        const customExerciseVideo = document.getElementById('custom-exercise-video');
        const customExerciseType = document.getElementById('custom-exercise-type');
        const addCustomExerciseBtn = document.getElementById('add-custom-exercise-btn');
        const customExerciseList = document.getElementById('custom-exercise-list');
        const streakCountDisplay = document.getElementById('streak-count');

        // Global Variables
        let timerInterval, timeLeft, isPaused = true;
        let currentWorkoutPlan = [], currentExerciseIndex = 0, currentWorkoutType = '';
        let currentCalendarDate = new Date();
        let exerciseProgress = JSON.parse(localStorage.getItem('exerciseProgress')) || {};
        let workoutStreak = JSON.parse(localStorage.getItem('workoutStreak')) || { count: 0, lastDate: '' };

        // Timer Functions
        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = seconds % 60;
            return `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
        }

        function updateTimerDisplay() {
            timerDisplay.textContent = formatTime(timeLeft);
        }

        function startTimer() {
            if (!isPaused) return;
            isPaused = false;
            startPauseBtn.innerHTML = '<i class="fas fa-pause mr-2"></i>Pause';
            startPauseBtn.classList.remove('btn-primary');
            startPauseBtn.classList.add('btn-secondary');
            timerInterval = setInterval(() => {
                if (timeLeft > 0) {
                    timeLeft--;
                    updateTimerDisplay();
                } else {
                    clearInterval(timerInterval);
                    isPaused = true;
                    startPauseBtn.innerHTML = '<i class="fas fa-play mr-2"></i>Start';
                    startPauseBtn.classList.remove('btn-secondary');
                    startPauseBtn.classList.add('btn-primary');
                    showMessage("Exercise Completed! Move to the next one.");
                }
            }, 1000);
        }

        function pauseTimer() {
            clearInterval(timerInterval);
            isPaused = true;
            startPauseBtn.innerHTML = '<i class="fas fa-play mr-2"></i>Start';
            startPauseBtn.classList.remove('btn-secondary');
            startPauseBtn.classList.add('btn-primary');
        }

        function resetTimer() {
            pauseTimer();
            timeLeft = currentWorkoutPlan[currentExerciseIndex].duration;
            updateTimerDisplay();
            showMessage("Timer has been reset.");
        }

        function displayExercise(exercise) {
            currentExerciseName.textContent = exercise.name;
            currentExerciseReps.textContent = exercise.reps;
            timeLeft = exercise.duration;
            updateTimerDisplay();
            isPaused = true;
            pauseTimer();
            youtubeVideoContainer.innerHTML = exercise.video ?
                `<iframe src="${exercise.video}?autoplay=0&controls=1&modestbranding=1&rel=0" title="${exercise.name} video" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>` :
                `<p class="text-gray-500 dark-mode:text-gray-400">No reference video available for this exercise.</p>`;
            nextExerciseInfo.textContent = currentExerciseIndex + 1 < currentWorkoutPlan.length ?
                `Next: ${currentWorkoutPlan[currentExerciseIndex + 1].name} (${currentWorkoutPlan[currentExerciseIndex + 1].reps})` :
                "This is the last exercise in this segment!";
        }

        function loadNextExercise() {
            currentExerciseIndex++;
            if (currentExerciseIndex < currentWorkoutPlan.length) {
                displayExercise(currentWorkoutPlan[currentExerciseIndex]);
            } else {
                showMessage("Congratulations! You've completed this workout segment. Time for the next part or stretching!");
                nextExerciseInfo.textContent = "Workout segment completed!";
            }
        }

        // Workout Initialization
        function initializeWorkoutPlan() {
            const today = new Date();
            const dayOfWeek = today.getDay();
            if (dayOfWeek === 1 || dayOfWeek === 3 || dayOfWeek === 5) {
                currentWorkoutType = 'corePosture';
                currentWorkoutPlan = [...exercises.warmUp, ...exercises.corePosture, ...exercises.stretching, ...exercises.kegel];
            } else if (dayOfWeek === 2 || dayOfWeek === 4 || dayOfWeek === 6) {
                currentWorkoutType = 'staminaFullBody';
                currentWorkoutPlan = [...exercises.warmUp, ...exercises.staminaFullBody, ...exercises.stretching, ...exercises.kegel];
            } else {
                currentWorkoutType = 'restDay';
                currentWorkoutPlan = [...exercises.stretching, ...exercises.kegel];
                showMessage("It's Sunday! Rest & Recovery day. Focus on stretching and Kegel.");
            }
            currentExerciseIndex = 0;
            if (currentWorkoutPlan.length > 0) {
                displayExercise(currentWorkoutPlan[currentExerciseIndex]);
            } else {
                currentExerciseName.textContent = "No workout planned for today.";
                currentExerciseReps.textContent = "";
                timerDisplay.textContent = "00:00";
                youtubeVideoContainer.innerHTML = "";
                nextExerciseInfo.textContent = "";
                startPauseBtn.disabled = true;
                resetBtn.disabled = true;
                nextExerciseBtn.disabled = true;
            }
        }

        // Calendar Functions
        function renderCalendar() {
            calendarDaysContainer.innerHTML = '';
            const year = currentCalendarDate.getFullYear();
            const month = currentCalendarDate.getMonth();
            currentMonthYearDisplay.textContent = new Date(year, month).toLocaleString('en-us', { month: 'long', year: 'numeric' });
            const firstDayOfMonth = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            for (let i = 0; i < firstDayOfMonth; i++) {
                const emptyDay = document.createElement('div');
                emptyDay.classList.add('calendar-day');
                calendarDaysContainer.appendChild(emptyDay);
            }
            for (let day = 1; day <= daysInMonth; day++) {
                const dayElement = document.createElement('div');
                dayElement.classList.add('calendar-day', 'current-month');
                dayElement.textContent = day;
                const fullDate = `${year}-${(month + 1).toString().padStart(2, '0')}-${day.toString().padStart(2, '0')}`;
                const today = new Date();
                const todayFormatted = `${today.getFullYear()}-${(today.getMonth() + 1).toString().padStart(2, '0')}-${today.getDate().toString().padStart(2, '0')}`;
                if (fullDate === todayFormatted) dayElement.classList.add('today');
                if (exerciseProgress[fullDate]) dayElement.classList.add(exerciseProgress[fullDate]);
                dayElement.addEventListener('click', () => {
                    if (fullDate !== todayFormatted) {
                        showMessage(`You can only mark today's progress. For ${fullDate}, it is already marked as ${exerciseProgress[fullDate] || 'unmarked'}.`);
                    }
                });
                calendarDaysContainer.appendChild(dayElement);
            }
            updateChart();
        }

        function saveProgress(date, status) {
            exerciseProgress[date] = status;
            localStorage.setItem('exerciseProgress', JSON.stringify(exerciseProgress));
            updateStreak(date, status);
            renderCalendar();
        }

        function updateStreak(date, status) {
            const today = new Date();
            const yesterday = new Date(today);
            yesterday.setDate(today.getDate() - 1);
            const yesterdayFormatted = `${yesterday.getFullYear()}-${(yesterday.getMonth() + 1).toString().padStart(2, '0')}-${yesterday.getDate().toString().padStart(2, '0')}`;
            if (status === 'completed' && date === `${today.getFullYear()}-${(today.getMonth() + 1).toString().padStart(2, '0')}-${today.getDate().toString().padStart(2, '0')}`) {
                if (workoutStreak.lastDate === yesterdayFormatted && exerciseProgress[yesterdayFormatted] === 'completed') {
                    workoutStreak.count++;
                } else if (workoutStreak.lastDate !== date) {
                    workoutStreak.count = 1;
                }
                workoutStreak.lastDate = date;
            } else if (status === 'skipped') {
                workoutStreak.count = 0;
                workoutStreak.lastDate = '';
            }
            streakCountDisplay.textContent = workoutStreak.count;
            localStorage.setItem('workoutStreak', JSON.stringify(workoutStreak));
        }

        // Progress Chart
        let progressChart;
        function updateChart() {
            const ctx = document.getElementById('progress-chart').getContext('2d');
            const month = currentCalendarDate.getMonth();
            const year = currentCalendarDate.getFullYear();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const labels = Array.from({ length: daysInMonth }, (_, i) => i + 1);
            const completedDays = labels.map(day => {
                const date = `${year}-${(month + 1).toString().padStart(2, '0')}-${day.toString().padStart(2, '0')}`;
                return exerciseProgress[date] === 'completed' ? 1 : 0;
            });
            const isDarkMode = document.body.classList.contains('dark-mode');
            if (progressChart) progressChart.destroy();
            progressChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels,
                    datasets: [{
                        label: 'Workouts Completed',
                        data: completedDays,
                        backgroundColor: isDarkMode ? '#10b981' : '#4f46e5',
                        borderColor: isDarkMode ? '#059669' : '#4338ca',
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        y: { beginAtZero: true, max: 1, ticks: { stepSize: 1 } },
                        x: { title: { display: true, text: 'Day of Month' } }
                    },
                    plugins: { legend: { display: false } }
                }
            });
        }

        // Custom Exercises
        function populateCustomExercises() {
            customExerciseList.innerHTML = '';
            Object.keys(exercises).forEach(type => {
                exercises[type].forEach((ex, index) => {
                    if (ex.isCustom) {
                        const li = document.createElement('li');
                        li.innerHTML = `<span class="font-semibold">${ex.name}</span> ‚Äì ${ex.reps} (${ex.duration} sec) <button class="text-red-500 ml-2" onclick="deleteCustomExercise('${type}', ${index})"><i class="fas fa-trash"></i></button>`;
                        customExerciseList.appendChild(li);
                    }
                });
            });
        }

        function deleteCustomExercise(type, index) {
            exercises[type].splice(index, 1);
            localStorage.setItem('exercises', JSON.stringify(exercises));
            populateList();
            populateCustomExercises();
            showMessage('Custom exercise deleted.');
        }

        // Notifications
        function requestNotificationPermission() {
            if (!("Notification" in window)) {
                showMessage("This browser does not support notifications.");
                return;
            }
            Notification.requestPermission().then(permission => {
                if (permission === "granted") {
                    showMessage("Notification permission granted! You can now set reminders.");
                } else {
                    showMessage("Notification permission denied. Please enable it in your browser settings.");
                }
            });
        }

        function scheduleNotification(time) {
            const [hours, minutes] = time.split(':').map(Number);
            const now = new Date();
            const notificationTime = new Date(now.getFullYear(), now.getMonth(), now.getDate(), hours, minutes);
            if (notificationTime < now) notificationTime.setDate(now.getDate() + 1);
            const msUntilNotification = notificationTime - now;
            setTimeout(() => {
                new Notification("Workout Reminder", {
                    body: "Time for your daily workout! Let's get moving!",
                    icon: 'https://via.placeholder.com/32?text=üèãÔ∏è'
                });
                // Reschedule for next day
                scheduleNotification(time);
            }, msUntilNotification);
            localStorage.setItem('reminderTime', time);
            showMessage(`Reminder set for ${time} daily!`);
        }

        // Event Listeners
        toggleSidebarBtn.addEventListener('click', () => {
            sidebar.classList.toggle('hidden');
        });

        startWorkoutBtn.addEventListener('click', () => {
            dailyPlanSection.classList.add('hidden');
            currentWorkoutSection.classList.remove('hidden');
            initializeWorkoutPlan();
        });

        startPauseBtn.addEventListener('click', () => {
            if (isPaused) startTimer(); else pauseTimer();
        });

        resetBtn.addEventListener('click', resetTimer);
        nextExerciseBtn.addEventListener('click', loadNextExercise);

        prevMonthBtn.addEventListener('click', () => {
            currentCalendarDate.setMonth(currentCalendarDate.getMonth() - 1);
            renderCalendar();
        });

        nextMonthBtn.addEventListener('click', () => {
            currentCalendarDate.setMonth(currentCalendarDate.getMonth() + 1);
            renderCalendar();
        });

        markCompletedBtn.addEventListener('click', () => {
            const today = new Date();
            const todayFormatted = `${today.getFullYear()}-${(today.getMonth() + 1).toString().padStart(2, '0')}-${today.getDate().toString().padStart(2, '0')}`;
            saveProgress(todayFormatted, 'completed');
            showMessage("Today's workout marked as COMPLETED! Great job!");
        });

        markSkippedBtn.addEventListener('click', () => {
            const today = new Date();
            const todayFormatted = `${today.getFullYear()}-${(today.getMonth() + 1).toString().padStart(2, '0')}-${today.getDate().toString().padStart(2, '0')}`;
            saveProgress(todayFormatted, 'skipped');
            showMessage("Today's workout marked as SKIPPED. Don't worry, you can always start fresh tomorrow!");
        });

        addCustomExerciseBtn.addEventListener('click', () => {
            const name = customExerciseName.value.trim();
            const reps = customExerciseReps.value.trim();
            const duration = parseInt(customExerciseDuration.value);
            const video = customExerciseVideo.value.trim();
            const type = customExerciseType.value;
            if (name && reps && duration) {
                exercises[type].push({ name, reps, duration, video, isCustom: true });
                localStorage.setItem('exercises', JSON.stringify(exercises));
                customExerciseName.value = '';
                customExerciseReps.value = '';
                customExerciseDuration.value = '';
                customExerciseVideo.value = '';
                populateList();
                populateCustomExercises();
                showMessage('Custom exercise added!');
            } else {
                showMessage('Please fill in all required fields.');
            }
        });

        setReminderBtn.addEventListener('click', () => {
            const time = prompt("Enter reminder time (HH:MM, 24-hour format):", "07:00");
            if (time && /^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/.test(time)) {
                requestNotificationPermission();
                scheduleNotification(time);
            } else {
                showMessage("Invalid time format. Please use HH:MM (e.g., 07:00).");
            }
        });

        // PWA Service Worker
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('service-worker.js').then(reg => {
                console.log('Service Worker registered:', reg);
            }).catch(err => {
                console.error('Service Worker registration failed:', err);
            });
        }

        // Initial Load
        document.addEventListener('DOMContentLoaded', () => {
            const populateList = (listElement, data) => {
                listElement.innerHTML = '';
                data.forEach(ex => {
                    const li = document.createElement('li');
                    li.innerHTML = `<span class="font-semibold">${ex.name}</span> ‚Äì ${ex.reps} ${ex.duration ? `(${ex.duration} sec)` : ''}`;
                    listElement.appendChild(li);
                });
            };
            populateList(warmUpList, exercises.warmUp);
            populateList(corePostureList, exercises.corePosture);
            populateList(staminaFullBodyList, exercises.staminaFullBody);
            populateList(stretchingList, exercises.stretching);
            populateList(kegelList, exercises.kegel);
            populateCustomExercises();
            renderCalendar();
            streakCountDisplay.textContent = workoutStreak.count;

            // Resume daily reminder if set
            const savedReminderTime = localStorage.getItem('reminderTime');
            if (savedReminderTime && Notification.permission === 'granted') {
                scheduleNotification(savedReminderTime);
            }
        });
    </script>
</body>
</html>
